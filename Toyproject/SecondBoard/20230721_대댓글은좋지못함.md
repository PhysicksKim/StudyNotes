
### 1) 대댓글 방식  
```
부모 댓글 1
├ 대댓글 1-1
├ 대댓글 1-2
├┬ 대대댓글 1-2-1
│└ 대대댓글 1-2-2
│　└ 대대대댓글 1-2-2-1
└ 대댓글 1-3
부모 댓글 2
├ 대댓글 2-1
└ 대댓글 2-2
　└ 대대댓글 2-2-1
```

사용자 입장에서 가장 기능이 풍부?한 방식이다.  
가독성 측면은 취향 차이가 있을 수 있으나  
명확히 어느 대댓글에 답을 달았는지 대대댓글로 계층적을 더 깊게 파고들 수 있어서  
대댓글 작성자가 굳이 어느 댓글에 답을 단 대댓글인지 내용에 직접 명시하지 않아도 되어서 좋다.  
  
그러나 가장 성능 문제를 크게 야기하는 방식이다.  
계층형 구조이기에  
  
<br>
  
### 2) 답글 방식  
```
부모 댓글 1
├ 답글 1
├ 답글 2
└ 답글 3
부모 댓글 2
├ 답글 1
└ 답글 2
```

대대댓글로 파고들지는 못하고  
부모 댓글 아래 계층에만 답글을 달 수 있다.  
  
이 방식은 대댓글 방식보다 조회 쿼리에서 성능상 이점이 있다.  

대댓글 방식은 재귀적으로 계속해서 실행되어야 하므로  
계층을 무한히 파고파고파고들면 성능문제가 생길 수 밖에 없는 구조다.  
하지만 답글 방식은 딱 한번만 부모 댓글 아래에 답글이 있는지만 조회하면 되므로  
조회 성능이 더 좋다.    
  
다만 사용자 입장에서는 조금 불편하다.  
앞선 대댓글과는 달리 대댓글에 다시 답을 해주고 싶을때에는  
대댓글과 달리 누구에게 답하는지 알려줄 수 없다.  
  
```
부모 댓글 1 
├ 답글 1 : Java Script 재밌어요! 
├ 답글 2 : 답글2 / Java Script 가 아니라 JavaScript 입니다. 붙여서 쓰는거에요.    
└ 답글 3 : ㅋㅋㅋㅋㅋㅋ
부모 댓글 2
├ 답글 1
└ 답글 2
```
  
이렇게 무한 대댓글과 다르게   
누구를 지칭하는지 시스템적으로 구분할 수 없다는 문제가 있다.     
다만 이 한계는 "지명" 방식으로 해결할 수 있다.  

<br>  
  
### 3) 지명 방식  
기본적으로 답글 방식과 같이 댓글에 대한 답글만 달 수 있는 구조이지만  

```
- 아이디 지명 

부모 댓글 1 
├ 답글 1 (juniordev): Java Script 재밌어요! 
├ 답글 2 (chobo)    : "@juniordev" Java Script 가 아니라 JavaScript 입니다. 붙여서 쓰는거에요.    
└ 답글 3 (someone)  : ㅋㅋㅋㅋㅋㅋ
```

```
- 댓글 번호 지명 

[1] (master)   : 첫 댓글 
[2] (juniordev): Java Script 재밌어요! 
[3] (chobo)    : "▶[2]" Java Script 가 아니라 JavaScript 입니다. 붙여서 쓰는거에요.    
[3] (someone)  : ㅋㅋㅋㅋㅋㅋ
```
  
특정 댓글 지명이 필요하면  
댓글 작성자 아이디나 댓글id 로 지명할 수 있도록 해준다.  
  
답글은 무한 대댓글처럼 지명이 불가능하니  
알림을 보내기 어려운 문제가 있었는데  
이를 적절한 식별자를 지명할 수 있도록 해서 해결한 형태이다.  
  

> ### 4) 플랫 방식
> 특이하게 답글조차 없는 사이트가 있다.
> 글 작성자의 댓글만 UI를 구분해주고
> 답글 자체가 아예 없는 형태다.
> 더 쿼리가 단순해지고 DB 부담도 줄어들기는 할텐데
> 이정도까지 댓글 제약을 만들 필요는 없을 것 같다.
> 당장 youtube 같이 가장 크고 트래픽이 세계에서 가장 많은 사이트도
> 전부 다 무한 스크롤 방식으로 리뉴얼 할 때  
> 답글 + 지명 방식을 그대로 놔두고 사용하고 있으니
> DB 부담이 그리 크지는 않은가보다
> 자세한건 당연히 따로 DB 성능 테스트를 해보는 게 맞겠지만
> 지금은 가닥을 잡아가는 과정이니 이렇게 생각하고 넘어가자  
  
  
# 커뮤니티 사이트의 댓글 방식들 조사  

23년 7월 기준  
한국 커뮤니티 사이트 트래픽 상위 10곳을 대상으로           
각 사이트의 대댓글 방식을 알아해봤다    
  
```
1. 답글
2. 대댓글
3. 대댓글
4. 지명(아이디)
5. 지명(댓글 번호)
6. 답글
7. 지명(아이디)
8. 대댓글
9. 플랫(답글 없음)
10. 답글
```
    
보다시피 3개 사이트만 무한 대댓글 구조를 채택하고 있다.  
이렇게 무한 대댓글을 지원하는 사이트가 적은 이유는 여럿 있을 수 있겠지만    
내 추측으로는 DB 부하 문제 때문이라고 생각한다.  
조회에서 너무 안좋은 모습을 보일 수 있기 때문일 듯 하다.  
  

## 글로벌 사이트 댓글 방식  
  
Youtube 와 Instagram 둘 다  
아이디 지명 방식을 사용한다.  
    
Tiktok은 내가 잘 모르는데, 얼핏 보니까 그냥 답글 방식인 것 같다.    
아이디 태그는 가능하지만 댓글을 지명하는 게 아니라 사람을 지명하는데 쓰는 것 같다.       
Facebook은 내 기억으로 대댓글과 무관하게 이름을 태그를 해서 알림을 보내는 식이다.   
댓글을 단 사람 아이디를 태그해서 알림을 보내도 되고, 그냥 친구 이름을 태그해버려도 알림이 간다.   
  
<br>  
  
유일하게 reddit 단 하나만 내가 아는 글로벌 대댓글 사이트이다.  
    
> 레딧은 이름은 유명한데 들어갈 때 마다 대체 어떻게 된 UI인지 모르겠다.
> comment를 그냥 보여주는 게 아니라 따로 정렬 방식이 다양한 것도 참 이상하다(DB 문제가 분명 있을텐데)    

<br><br>  
  
# 대댓글의 문제점  
당연하게 재귀적인 조회 쿼리가 문제다.  
아무리 여러 대댓글 알고리즘을 찾아봐도  
조회 쿼리가 너무 지저분해지는 것 같아서 이게 정말 최선일까 계속 의문이 들었다.  
  
그런데 가만히 생각해보니  
"꼭 대댓글일 필요가 없잖아?" 하면서 youtube가 떠올랐다  
조금 불편하긴 하더라도 DB 부담은 더 적은 지명 방식이 더 좋을 거 같다.  
사용자 입장에서는 대댓글이 가장 편하지만  
대댓글은 확실히 개발자와 DB 관점에서는 조회 쿼리와 여러 로직이 꼬인다는 측면에서 좋지 못한 것 같다.  
  
그리고 이러한 생각에 힘을 더해준 게   
현재 가장 인기있는 Youtube Instagram Tiktok 이 전부 대댓글 구조를 사용하지 않는다는 점이다.  
저정도 사이트 개발자면 대댓글 구조를 단순히 그냥 안만드는 게 아니라 무슨 생각이 있어서 안만들었을 것이다.  
그러고 youtube 에서 대댓글 구조에 대한 강의를 보니까  
"대댓글 개념은 오래된 사이트에서..." 라면서 대댓글이 그다지 좋지 않은 구조임을 역설하고 있었다.  

<br><br>  

# 요약  
대댓글은 특히 조회 성능 문제를 야기할 것 같다  
나는 답글 + 아이디 지명 방식을 사용하는 게 좋은 것 같다.    
