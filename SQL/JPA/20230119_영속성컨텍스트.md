# JPA 영속성 컨텍스트  

## Q. 영속성 컨텍스트란 뭔가?  
영속성(Persistence) 과 컨텍스트(context)로 나눠보자.  
  
- 영속성 : 데이터가 사라지지않고 영구적으로 보존됨  (persistence ; (없어지지 않고 오랜동안) 지속됨)  
- 컨텍스트 : '관련있는' 값들의 묶음 (ex. 현재 실행중인 앱의 함수와 변수들이 저장되는곳, 처리하고 있는 웹 요청이 들어있는 객체 등)  
  
**영속성**은    
데이터를 단순 메모리에 놔두는 게 아니라  
파일이나 DB에 **저장해두는 것**을 말한다  
더 넓게 잡으면, **상태를 유지시켜주는 것** 을 말한다  
  
**컨텍스트**는  
전역 컨텍스트, 실행 컨텍스트, 서블릿 컨텍스트 등  
다양한 곳에서 조합해서 쓰이는 말인데  
"앞에 붙는 말" + "관련 값들의 묶음" 이라고 보면 된다   
ex. 전역 컨텍스트는, 전역 : 프로그램의 전역 공간 + 전역공간에 있는 값들  
  
  
이렇게 두 단어를 바탕으로 다시 영속성 컨텍스트를 설명해보면  

#### 영속성 컨텍스트란    
DB에 값을 넣기 전에(영속성)  
그 값들을 저장해두는 곳(컨텍스트)  
를 말한다.  
  
<br><br>  
  
## Q. 엔티티 매니저란?  

- 먼저, entity란?  
  
JPA 에서 Entity 를 Manage 하는 객체를 말하는데   
    
Entity 란 DB에서 저장하고 관리하는 대상을 말한다  
각 테이블에 대응되는 개념으로 이해할 수 있는데  
JPA에서 언제 @Entity 라고 애노테이션을 달아줬는지 생각해보면 이해할 수 있다  
  
예를 들어보면  
```java
@Entity
public class Member {

  @Id
  private Long member_id;
  
  private String name;
  private int age;
  private String member_email;

  ...
}
```
위 코드는 JPA 기본 예제라도 해봤다면  
"이 코드대로라면, Member 라는 테이블이 생기고, member_id , name , age , member_email 이라는 컬럼이 생기겠구나"  
라는 것을 떠올릴 수 있을 거다.  
  
이를 바탕으로 @Entity 라는 애노테이션을 설명해보면    
"Member 라는 클래스는 Entity야"  
라는 것을 뜻하는데  
이는 다시 말하면  
"Member 클래스 보고 DB 테이블을 만들어라"  
라고도 말할 수 있다.  
  
따라서 정리해보면  
Entity 는 DB 테이블에 대응될 수 있으며  
본질적인 의미는 "DB로 다룰 어떤 것"을 말한다.  
  
- 그러면 entity Manager는?  
entity 에 접근하는데 문제가 생기지 않도록 도와주는 manager이다.  
근데 왜 entity에 접근하는데 문제가 생기는가?  
바로 JPA를 쓸떄는 영속성 컨텍스트를 거쳐서 entity를 다뤄야 하기 때문이다.  
  
<br><br>
  
## Q. 왜 영속성 컨텍스트를 거쳐서 entity를 다뤄야 하는가?  

속성 컨텍스트라는걸 써야지 패러다임 불일치를 해소할 수 있다.  
  
DB와 java oop 간의 패러다임 불일치를 먼저 이해하고  
추가로 JPA의 영속 상태, 비영속 상태, 영속성 컨텍스트를 활용했을 때 이점 등에 대한 이해가 먼저 필요하다.    
  
그러면 왜 영속성 컨텍스트를 쓰고,   
영속성 컨텍스트를 관리하기 위해서 entity manager를 통해서 entity 를 가져오는구나  
라는 것을 이해할 수 있다.  
