> 잡념에 대해 메모해둔 문서입니다.  
> 특정 주제에 대하여 정보를 기술한 문서가 아닙니다.  
  
[참고1 - spring mvc 에서 controller 테스트 코드에서는 뭘 테스트 해야할까?](https://hello-woody.medium.com/spring-mvc-%EC%97%90%EC%84%9C-controller-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C%EC%97%90%EC%84%9C%EB%8A%94-%EB%AD%98-%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%95%B4%EC%95%BC%ED%95%A0%EA%B9%8C-d398d5b4a35f)  

<br><br>

---

<br><br>
  
# 계기 - 뭘 테스트 해야하는거야?  
Controller 테스트 코드를 작성 해야겠는데    
어떻게 테스트를 작성해야 하지?  
  
대충 떠오르는 곳들을 생각해보면  
  
> 해당 url로 정상적으로 요청을 받고 응답을 보내는지     
> input에 맞춰 java object가 제대로 생성되는지  
> controller 가 비즈니스 로직을 정상적으로 호출하는지  
> 각종 validation 처리가 제대로 되는지  
  
이 정도 생각할 수 있다  
  
그런데 여기서 의문이 하나 생겼는데.  
  
<br><br>    
  
# 의문 - 근데, 테스트는 그냥 막 떠오르는거 대로 적는거야?  
지금 나는 테스트 코드 작성에 뭔가 기준이 없다.  
즉, "내가 놓친 부분이 없을까?" 에 대해서 체크해볼 구심점이 없다.  
  
예를 들면  
어떤 코드가 좋은가에 대해 이야기 할 때 기준은  
적어도 초보도 감을 잡을 수 있을만큼 심플하다.  
"다른 개발자도 읽기 쉬워야 하고, 기능을 덧 붙이거나 수정해도 사이드 이펙트가 적어야 좋은 코드다"  
그래서 중복을 줄여라 같은 아주 직관적이고 눈에 보이는 부분부터 자연스럽게 배워나갈 수 있다.  
  
그러나   
테스트는 조금 애매하다.  
FIRST 원칙이라던가 테스트 주도 개발 방식이 제시하는 바가 있기는 하다.  
그렇지만 좋은 테스트 코드 작성 방법과, 해당 구현체나 기능에 대한 적절한 테스트 주제들은  
전혀 다른 이야기다.  
  
무슨 말이냐면  
Service 를 테스트 한다고 해보자.  
그러면 정상 데이터가 주어질 때 각종 로직이 제대로 동작하는지 테스트를 작성해야 하고,    
예외를 제대로 처리하는지 테스트도 작성해야 한다.  
  
그러면 결국 Service에 대한 이해도가 높아야  
좋은 Service 테스트들을 제시할 수 있다.  
테스트 구현과, 좋은 테스트 거리들을 찾는 것은  
전혀 별개의 영역이다.  
  
<br><br>  
  
# 이해 - 결국, 처음부터 완벽한 코드는 없다  
신입의 불안은 이렇다.  
"코드 이렇게 짜도 되는걸까? 뭐라도 문제가 생길 거 같은데."  
"이거 보안 괜찮은 거 맞아? 실무 코드는 이렇게 단순하지 않을텐데."  
  
그치만 이는 TDD에서 제일 처음 말하는 주제다.  
"처음부터 완벽한 코드를 작성하는 것은 불가능하다"    
  
이를 풀어서 해석해보면 이렇다.  
  
> 어차피 너 완벽한 코드 못 짜잖아?  
> 그럴 바에 그냥 테스트 코드로 가닥을 먼저 잡아봐.  
> 그러면 가닥 잡다가 대충 코드 흐름이 어떨지 눈에 보기에 되고  
> 그 과정에서 부족한 부분이 보이면 구현과 리펙토링을 반복하는거야.  
> 그리고 테스트를 먼저 짜놓아야지 너가 리펙토링을 과감하게 할 수 있는거야.  
> 테스트 돌려서 리펙토링이 제대로 이뤄졌는지 테스트 할 수 있잖아?  
> 그러니까  
> 100% 좋은 코드를 한번에 짤 생각 하지말고  
> 일단 테스트로 큰 그림이나 핵심 그림부터 그려봐.  
  
이거다  
  
<br><br>  

# 결론 - 똑 부러지게 답할 수 없는 질문이었다. 
결국 내 질문은 답이 없는 궁극의 질문이었다.  
마치 "세상 모든 것을 계산할 수 있는 마스터키 같은 단 하나의 공식이 있나요?" 같은 소리였다.  
  
그리고 개발 공부라는게 매번 그런 식이다.  
뭔가 단계를 밟으면서 차곡차곡 쌓아올라가는 수학같은 게 아니라  
깨지고 부서지면서 케이스 바이 케이스로 배워나가는 느낌이 힌층 더 강하다.  
  
> 단계에 따라 배울 수 있는 엔지니어링은 없다.   
> 그나마 수학 물리 같은 순수 논리 학문에서 해당할법한 이상적인 이야기다.  
> 엔지니어링 자체가 노하우 집약이다.  
> 기계 엔지니어, 전기전자 엔지니어, 소프트웨어 엔지니어 다 비슷하다.    
> 결국 무언가 기본 원리는 있지만, 실제로 제품을 만들어 낼 때에는 노하우가 중요하다  
  
## 계기였던 질문. "Controller 테스트 코드는 어떤 부분을 테스트 해야하나요?"  
당연히 가닥은 잡아줄 수 있겠지만, 오롯이 개발자의 몫이다.  
전형적으로 Controller가 담는 문제는 앞서 예상한 바와 같지만  
저마다 다른 중요한 포인트가 있을거다.  
  
실수로 수정이 일어날 수 있을법한 곳에 대한 테스트,  
핵심 로직의 객체지향적인 구현이 요구되는 부분에 대한 테스트,    
전체적인 틀을 제시해주는 테스트 등  
  
테스트가 필요한 부분은 다양하게 있다.  
단순히 메서드에 테스트 코드를 작성해라는 게 아니라  
본질적으로 왜 테스트코드가 필요할가에 대해서 다시 생각해보게 됐다.  
  
1. 사이드 이펙트 체크  
2. 아키텍처에 대한 방향성 제시  
3. 전체적인 설계 방향을 테스트코드로 그려보기  

"왜 테스트 코드를 작성하는가?"에는 이 정도 떠오른다.  

## 좋은 테스트 코드 = "해당 구현체의 역할 이해" + "왜 테스트 코드를 작성하는가"
"Controller 테스트 코드는 어떤 부분을 테스트 해야하나요?" 라는 질문을 다시 보자  
  
### 1. 해당 구현체의 역할 이해 - Controller의 역할은?    
Controller 가 뭘 담당하는가?   
Controller 자체를 이해해야한다.    
어디가 핵심이고 어디가 변경이 자주 일어나며 큰 골격은 어떤지 알아야 한다.  
  
근데 이건 그냥 개발공부다.  
어느 한 분야를 안다고 끝나는 게 아니라  
그냥 이것 저것 알아가고 연차와 노하우가 쌓여야지 해결된다.   
  
어떤 키워드가 딱 있는 게 아니라.  
여러 키워드들을 주워서 배우면  
이런 부분도 저런 부분도 보이게 되면서  
자연스렇게 Controller에서 더 많은 테스트 포인트들이 보이게 될 것이다.  
  
그러니 역할 이해는 아주 추상적이고 궁극적인거다 
키워드 하나 딱 던져주고 그걸로 검색해서 공부한다고 해결되는 게 아니다.  
계속 대화하고 다른 개발자와 이야기하고 공유하면서 더 많은 개발 지식을 추구하는 수 밖에.  
  
### 2. 왜 테스트 코드를 작성하는가 - TDD와 테스트에 대한 이해    
TDD는 개발 방식이고 테스트는 도구다.  
  
테스트를 사용하는 이유와  
TDD를 채택하는 이유는   
별개의 이야기이다.  
  
그치만 왜 테스트 코드를 작성해야 하는가에 대해서는  

> 왜 테스트 코드 작성 = TDD의 목적 + 테스트 자체의 목적 

이라고 생각한다. (다른 추가 요소가 있을지도 모르겠다)  
  
이게 시사하는 바는  
TDD를 잘 이해하고, 테스트 라는 도구를 더 잘 이해하면  
결국 "왜 테스트 코드를 작성하는가"에 대해 더 잘 알 수 있게 되지 않을까? 싶다  

<br><br>

---

<br><br>  

# 최종 결론  
1. 좋은 테스트 코드 = "**해당 구현체의 역할 이해**" + "**왜 테스트 코드를 작성하는가**"   
  
2. "**해당 구현체의 역할 이해**" = 각종 관련 지식들을 총합(웹지식, db지식, 보안지식, 노하우 등등)    
  
3. "**왜 테스트 코드 작성**" = TDD의 목적 + 테스트 자체의 목적      
  
